Step 1ï¸âƒ£ â€” AUTHENTICATION & USER MANAGEMENT MODULE

Hereâ€™s your first prompt to use (copy-paste into Replit AI or your IDEâ€™s AI assistant):

ğŸ§  Prompt 1: Authentication & User Management API Design (Python FastAPI backend)

Create a detailed API design (Markdown format) for the Authentication & User Management Module of an LMS backend.
Use FastAPI + JWT Authentication + SQLAlchemy ORM.

Include:

Endpoint list (signup, login, logout, refresh, profile, role assignment)

Request/response payloads (JSON)

Access role rules (Super Admin, Admin, Tutor, Student)

Error codes and validation rules

Database models (User, Role, Permission)

Include JWT-based middleware description

Add inline notes where database queries or external integrations will happen

Example successful and failed responses

ğŸ¯ Endpoints to include:

1. POST /api/auth/signup â€” Register new user
2. POST /api/auth/login â€” Authenticate and return JWT
3. POST /api/auth/logout â€” Invalidate token
4. GET /api/auth/refresh â€” Refresh JWT token
5. GET /api/users/profile â€” Fetch logged-in user info
6. GET /api/users â€” List all users (Super Admin & Admin only)
7. PUT /api/users/{id}/role â€” Assign or update a userâ€™s role
8. DELETE /api/users/{id} â€” Remove user (Super Admin only)

ğŸ’¾ Database Models (show fields + types)

User â†’ id, name, email, password_hash, role_id, status, created_at

Role â†’ id, name (Admin, Tutor, Student, SuperAdmin)

Permission â†’ id, feature_name, role_id

ğŸ§± JWT Middleware Description

Validate Authorization: Bearer <token> header

Decode and verify token

Inject user info into request.state.user

Return 401 if invalid or expired

ğŸ“¦ Example Payloads:

Signup Request:

{
  "name": "John Doe",
  "email": "john@example.com",
  "password": "Secret123!",
  "role": "Tutor"
}


Login Response:

{
  "access_token": "<JWT_TOKEN>",
  "refresh_token": "<JWT_REFRESH>",
  "role": "Tutor"
}

âŒ Error Handling:

400 â†’ Invalid input

401 â†’ Invalid credentials

403 â†’ Access denied (role mismatch)

409 â†’ Email already registered

ğŸ” Access Control Matrix:
Endpoint	Super Admin	Admin	Tutor	Student
/signup	âœ…	âŒ	âŒ	âŒ
/login	âœ…	âœ…	âœ…	âœ…
/users	âœ…	âœ…	âŒ	âŒ
/users/{id}/role	âœ…	âŒ	âŒ	âŒ
/logout	âœ…	âœ…	âœ…	âœ…
/profile	âœ…	âœ…	âœ…	âœ…

âš¡ Output format: A clean Markdown document ready for developer handover.