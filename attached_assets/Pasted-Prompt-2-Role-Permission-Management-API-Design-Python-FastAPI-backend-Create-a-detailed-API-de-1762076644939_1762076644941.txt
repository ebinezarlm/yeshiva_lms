Prompt 2: Role & Permission Management API Design (Python FastAPI backend)

Create a detailed API design (Markdown format) for the Role & Permission Management Module of a Learning Management System (LMS).

Use FastAPI + SQLAlchemy, and assume JWT authentication is already implemented.

ğŸ¯ Purpose:

The Super Admin should be able to:

Create and manage roles (Admin, Tutor, Student)

Define and assign features (permissions) to each role

Modify which features are enabled or disabled per role (via checkboxes in UI)

Retrieve role-wise access data for frontend dashboards and sidebars

ğŸ§© Endpoints:

1. GET /api/roles â†’ List all roles
2. POST /api/roles â†’ Create a new role
3. GET /api/roles/{id} â†’ Fetch details of a role
4. PUT /api/roles/{id} â†’ Update role name or description
5. DELETE /api/roles/{id} â†’ Remove a role (Super Admin only)
6. GET /api/permissions â†’ List all available features/permissions in the system
7. POST /api/roles/{id}/permissions â†’ Assign permissions to a role
8. GET /api/roles/{id}/permissions â†’ Get assigned permissions for a role
9. DELETE /api/roles/{id}/permissions/{permission_id} â†’ Revoke a permission

ğŸ§± Database Models
Role
class Role(Base):
    __tablename__ = "roles"
    id = Column(Integer, primary_key=True)
    name = Column(String, unique=True)
    description = Column(String)
    created_at = Column(DateTime)

Permission
class Permission(Base):
    __tablename__ = "permissions"
    id = Column(Integer, primary_key=True)
    feature_name = Column(String)
    description = Column(String)

RolePermission (Mapping Table)
class RolePermission(Base):
    __tablename__ = "role_permissions"
    id = Column(Integer, primary_key=True)
    role_id = Column(Integer, ForeignKey("roles.id"))
    permission_id = Column(Integer, ForeignKey("permissions.id"))

ğŸ§© Sample Permission Features

Admin: Dashboard, Users, Reports, Payments, Settings

Tutor: Upload Videos, Manage Playlists, View Comments, Earnings

Student: Explore, My Courses, Subscriptions, Profile

ğŸ“¦ Example Payloads

Create Role Request

{
  "name": "Tutor",
  "description": "Can upload and manage learning content"
}


Assign Permissions Request

{
  "permissions": ["Upload Videos", "Manage Playlists", "Earnings"]
}


Response Example

{
  "role": "Tutor",
  "assigned_permissions": ["Upload Videos", "Manage Playlists", "Earnings"]
}

ğŸ”’ Access Rules
Endpoint	Super Admin	Admin	Tutor	Student
GET /roles	âœ…	âœ…	âŒ	âŒ
POST /roles	âœ…	âŒ	âŒ	âŒ
PUT /roles/{id}	âœ…	âŒ	âŒ	âŒ
DELETE /roles/{id}	âœ…	âŒ	âŒ	âŒ
GET /permissions	âœ…	âœ…	âœ…	âœ…
POST /roles/{id}/permissions	âœ…	âŒ	âŒ	âŒ
DELETE /roles/{id}/permissions/{pid}	âœ…	âŒ	âŒ	âŒ
ğŸ’¬ Notes

Use role-based middleware to verify Super Admin access before modifying roles/permissions.

Store permission definitions statically (seed data) or in DB table.

Link role IDs with users from the users table.

Add caching for permission lookups (e.g., Redis or in-memory cache).